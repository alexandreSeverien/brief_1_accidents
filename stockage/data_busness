CREATE TABLE IF NOT EXISTS region (
    reg_code TEXT PRIMARY KEY,
    reg_name TEXT,
    gps TEXT
);

CREATE TABLE IF NOT EXISTS departement (
    dep_code TEXT PRIMARY KEY,
    dep_name TEXT,
    reg_code TEXT,
    insee TEXT,
    dep TEXT,
    FOREIGN KEY (reg_code) REFERENCES region(reg_code)
);

CREATE TABLE IF NOT EXISTS epci (
    epci_code TEXT PRIMARY KEY,
    epci_name TEXT,
    dep_code TEXT,
    FOREIGN KEY (dep_code) REFERENCES departement(dep_code)
);

CREATE TABLE IF NOT EXISTS commune (
    com_code TEXT PRIMARY KEY,
    com_name TEXT,
    com_arm_name TEXT,
    epci_code TEXT,
    dep_code TEXT,
    nom_com TEXT,
    adresse TEXT,
    lat REAL,
    long REAL,
    code_postal TEXT,
    coordonnees TEXT,
    com TEXT,
    num TEXT,
    FOREIGN KEY (epci_code) REFERENCES epci(epci_code),
    FOREIGN KEY (dep_code) REFERENCES departement(dep_code)
);

CREATE TABLE IF NOT EXISTS accident (
    num_acc TEXT PRIMARY KEY,
    com_code TEXT,
    adr TEXT,
    datetime TEXT,
    year_georef TEXT,
    FOREIGN KEY (com_code) REFERENCES commune(com_code)
);

CREATE TABLE IF NOT EXISTS circonstances_accident (
    num_acc TEXT PRIMARY KEY,
    lum TEXT, agg TEXT, int TEXT, atm TEXT, col TEXT, pr TEXT,
    surf TEXT, v1 TEXT, v2 TEXT, circ TEXT, vosp TEXT, env1 TEXT,
    voie TEXT, larrout TEXT, lartpc TEXT, nbv TEXT, catrl TEXT,
    pr1 TEXT, plan TEXT, prof TEXT, infra TEXT, situ TEXT,
    secu_utl TEXT, trajet TEXT, sens TEXT, obsm TEXT, obs TEXT,
    FOREIGN KEY (num_acc) REFERENCES accident(num_acc) ON DELETE CASCADE
);

CREATE TABLE IF NOT EXISTS vehicule (
    num_acc TEXT,
    num_veh TEXT,
    place TEXT,
    choc TEXT,
    manv TEXT,
    catv TEXT,
    secu TEXT,
    PRIMARY KEY (num_acc, num_veh),
    FOREIGN KEY (num_acc) REFERENCES accident(num_acc) ON DELETE CASCADE
);

CREATE TABLE IF NOT EXISTS personne (
    id_personne INTEGER PRIMARY KEY AUTOINCREMENT,
    num_acc TEXT,
    num_veh TEXT,
    an_nais TEXT,
    sexe TEXT,
    actp TEXT,
    grav TEXT,
    locp TEXT,
    catu TEXT,
    etatp TEXT,
    occutc TEXT,
    FOREIGN KEY (num_acc, num_veh) REFERENCES vehicule(num_acc, num_veh) ON DELETE SET NULL
);